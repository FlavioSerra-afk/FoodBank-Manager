<?xml version="1.0"?>
<ruleset name="FoodBank Manager">
  <description>Security-first PHPCS for FoodBank Manager (namespaced WP plugin).</description>

  <file>includes/Core</file>
  <file>includes/UI</file>
  <file>includes/Attendance</file>
  <file>templates</file>
  <file>tests</file>

  <!-- Exclusions -->
  <exclude-pattern>vendor/*</exclude-pattern>
  <exclude-pattern>dist/*</exclude-pattern>
  <exclude-pattern>node_modules/*</exclude-pattern>
  <exclude-pattern>.github/*</exclude-pattern>
  <exclude-pattern>analysis/*</exclude-pattern>
  <exclude-pattern>build/*</exclude-pattern>
  <exclude-pattern>bin/*</exclude-pattern>
  <exclude-pattern>Docs/*</exclude-pattern>
  <exclude-pattern>legacy/*</exclude-pattern>

  <!-- Primary standards -->
  <rule ref="WordPress-Extra"/>
  <rule ref="WordPress-Docs"/>
  <rule ref="PHPCompatibilityWP"/>

  <!-- Target platforms -->
  <config name="testVersion" value="8.1-8.3"/>
  <config name="minimum_supported_wp_version" value="6.0"/>

  <!-- Keep security sniffs STRICT -->
  <rule ref="WordPress.Security.EscapeOutput"/>
  <rule ref="WordPress.Security.NonceVerification"/>
  <rule ref="WordPress.Security.ValidatedSanitizedInput"/>
  <rule ref="WordPress.DB.PreparedSQL"/>
  <rule ref="WordPress.DB.PreparedSQLPlaceholders"/>

  <!-- De-noise low-signal style -->
  <exclude name="Generic.WhiteSpace.*"/>
  <exclude name="Generic.Formatting.MultipleStatementAlignment"/>
  <exclude name="PEAR.Functions.FunctionCallSignature.*"/>
  <exclude name="Universal.Arrays.DisallowShortArraySyntax.Found"/>

  <!-- Line length: be realistic -->
  <rule ref="Generic.Files.LineLength">
    <properties>
      <property name="lineLimit" value="160"/>
      <property name="absoluteLineLimit" value="240"/>
      <property name="ignoreComments" value="true"/>
    </properties>
  </rule>

  <!-- We’re namespaced, don’t require global prefixes or Yoda -->
  <exclude name="WordPress.PHP.YodaConditions"/>
  <exclude name="WordPress.NamingConventions.PrefixAllGlobals"/>
  <rule ref="WordPress.Files.FileName">
    <severity>0</severity>
  </rule>

  <rule ref="WordPress.WP.Capabilities">
    <properties>
      <property name="custom_capabilities" type="array">
        <element value="fb_manage_dashboard"/>
        <element value="fb_manage_attendance"/>
        <element value="fb_manage_database"/>
        <element value="fb_manage_forms"/>
        <element value="fb_manage_settings"/>
        <element value="fb_manage_diagnostics"/>
        <element value="fb_manage_permissions"/>
        <element value="fb_manage_theme"/>
        <element value="fb_view_sensitive"/>
      </property>
    </properties>
  </rule>

  <rule ref="WordPress.PHP.DiscouragedPHPFunctions">
    <exclude name="WordPress.PHP.DiscouragedPHPFunctions.obfuscation_base64_encode"/>
  </rule>
</ruleset>
